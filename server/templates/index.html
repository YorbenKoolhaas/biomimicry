<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Robotic Arm Control</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="container">

        <h1>Robotic Arm Control Panel</h1>

        <!-- Coordinate Input Section -->
        <div class="card">
            <h2>Set Coordinates</h2>
            <form id="coordForm">
                <div class="coord-grid">
                    <label>X <input id="x" type="number" step="10" value="150"></label>
                    <label>Y <input id="y" type="number" step="10" value="150"></label>
                    <label>Z <input id="z" type="number" step="10" value="0"></label>
                </div>
                <button class="submit-btn" type="submit">Send Coordinates</button>
            </form>
            <p id="status"></p>
        </div>

        <!-- Incremental Movement Section -->
        <div class="card">
            <h2>Incremental Movement</h2>
            <div class="movement-grid">

                <div class="axis-group">
                    <h3>X Axis</h3>
                    <button onclick="increaseCoords('x', 10)">X +</button>
                    <button onclick="increaseCoords('x', -10)">X -</button>
                </div>

                <div class="axis-group">
                    <h3>Y Axis</h3>
                    <button onclick="increaseCoords('y', 10)">Y +</button>
                    <button onclick="increaseCoords('y', -10)">Y -</button>
                </div>

                <div class="axis-group">
                    <h3>Z Axis</h3>
                    <button onclick="increaseCoords('z', 10)">Z +</button>
                    <button onclick="increaseCoords('z', -10)">Z -</button>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>Move scissors</h2>
            <form id="scissorsForm">
                <div class="coord-grid">
                    <label>Extend <input id="amount" type="number" step="1" value="10"></label>
                </div>
                <button class="submit-btn" type="submit">Send scissors</button>
            </form>
            <p id="status"></p>
        </div>

        <!-- Future Video Panels -->
        <div class="card video-area">
            <h2>Camera Streams (In construction)</h2>
            <div class="video-grid">
                <div class="video-box">Cam1 Feed</div>
                <div class="video-box">Cam2 Feed</div>
                <div class="video-box">YOLOv8 Detection?</div>
            </div>
        </div>

    </div>

    <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
    <script>
        const socket = io();

        document.getElementById("coordForm").addEventListener("submit", (event) => {
            event.preventDefault(); // prevents page reload
            sendCoords();
        });

        document.getElementById("scissorsForm").addEventListener("submit", (event) => {
            event.preventDefault(); // prevents page reload
            sendScissors();
        });

        function sendCoords() {
            const x = document.getElementById("x").value;
            const y = document.getElementById("y").value;
            const z = document.getElementById("z").value;

            socket.emit('send_coords', { x, y, z });
            console.log(`Sending coords: x=${x}, y=${y}, z=${z}`);
        }

        function increaseCoords(axis, amount) {
            socket.emit('increase_coords', { axis, amount });
        }

        function sendScissors() {
            const amount = document.getElementById("amount").value;

            socket.emit('move_scissors', { amount });
        }

        socket.on("coords_updated", (pos) => {
        document.getElementById("x").value = pos.x;
        document.getElementById("y").value = pos.y;
        document.getElementById("z").value = pos.z;
        document.getElementById("status").innerText = "Position updated.";
        });

        socket.on("error_msg", (msg) => {
            document.getElementById("status").innerText = "Error: " + msg;
        });
    </script>
</body>
</html>
